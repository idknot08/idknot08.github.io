---
title: Teslacrypt Ransomware
date: 2025-09-25 07:00:00 +0700
categories: [Malware, Ransomware]
tags: [teslacrypt, unpacking, analysis]
description: PhÃ¢n tÃ­ch máº«u ransomware Teslacrypt - phÃ¡t hiá»‡n packing, dump payload, nháº­n diá»‡n thÃ nh pháº§n chÃ­nh qua debug vÃ  kiá»ƒm tra PE.
media_subpath: /resources/demo1_ransomware
---

## ğŸ“Œ 1. Kiá»ƒm tra thÃ´ng tin cÆ¡ báº£n

- **TÃªn file:** `demo1_ransomware.bin` (Teslacrypt ransomware)
- **MD5:** `9ce01dfbf25dfea778e57d8274675d6f`

### ğŸ”¸ Káº¿t quáº£ VirusTotal
`Trojan.Teslacrypt ransomware`
![Káº¿t quáº£ VirusTotal](Pasted%20image%2020251003070446.png)

### ğŸ”¸ ExeinfoPE
- Loáº¡i file: 32-bit, GUI
![ExeinfoPE](Pasted%20image%2020251003070713.png)

### ğŸ”¸ DIE (Detect It Easy)
- **Heuristics:** Packer detected
- Entropy `.data` section = **7.629** â†’ dáº¥u hiá»‡u bá»‹ pack
![DIE - Heuristics](Pasted%20image%2020251003070801.png)

### ğŸ”¸ PEstudio
![Pestudio - tá»•ng quan](Pasted%20image%2020251003071323.png)
![Pestudio - sections](Pasted%20image%2020251003072403.png)

**Nháº­n xÃ©t nhanh:**
- CÃ³ section láº¡ `para`
- `.data` cÃ³ quyá»n ghi + entropy cao â†’ kháº£ nÄƒng unpack táº¡i chá»—
- `code`, `crt`, `erloc` section Ä‘á»u cÃ³ entropy cao, khÃ´ng chuáº©n
- **Indicators** cÃ³ dÃ²ng: `imports > flag > count,1,1`
- Gá»i API `GlobalMemoryStatus` (KERNEL32.dll) â†’ thu tháº­p thÃ´ng tin bá»™ nhá»›

![Pestudio - imports](Pasted%20image%2020251003072240.png)

---

## ğŸ§­ 2. Debug báº±ng x64dbg

Dá»±a vÃ o cÃ¡c dáº¥u hiá»‡u packer, ta **Ä‘áº·t breakpoint táº¡i `VirtualAlloc`**. API nÃ y Ä‘Æ°á»£c gá»i 2 láº§n:

### ğŸŸ¡ Láº§n 1
- Äá»‹a chá»‰ cáº¥p phÃ¡t: `00A40000`
- Size: `0004A000`
- Protection: `-RW--`
- Dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o vÃ¹ng nhá»›:

![Dump láº§n 1](Pasted%20image%2020251003074717.png)

---

### ğŸŸ¡ Láº§n 2
- Äá»‹a chá»‰ cáº¥p phÃ¡t: `00A90000`
- Size: `00085000`
- Protection: `ERW--`

![Dump láº§n 2](Pasted%20image%2020251003075109.png)

Quan sÃ¡t tháº¥y pháº§n Ä‘áº§u cÃ³ dáº¡ng giá»‘ng PE, nhÆ°ng khÃ´ng Ä‘áº§y Ä‘á»§ â†’ dump **vÃ¹ng nhá»› láº§n 1** Ä‘á»ƒ kiá»ƒm tra.

---

## ğŸ” 3. PhÃ¡t hiá»‡n cáº¥u trÃºc PE áº©n

Sau khi kiá»ƒm tra vÃ¹ng nhá»› dump, phÃ¡t hiá»‡n **2 vá»‹ trÃ­ nghi ngá» chá»©a PE header**:

```
00006AFB 4D5A MZ 000000B0 ( PE )
Exe PE detected at offset :00006AFB - section : ???
0000940F 4D5A MZ 00000100 ( PE )
Exe PE detected at offset :0000940F - section : ???
```


Dump 2 vÃ¹ng nÃ y â†’ thu Ä‘Æ°á»£c:

- `demo1_ransomware_dump1.bin`

![Dump1](Pasted%20image%2020251003080559.png)

- `demo1_ransomware_dump2.bin`

![Dump2](Pasted%20image%2020251003080807.png)

---

## ğŸ§  4. PhÃ¢n tÃ­ch payload dump

- **Dump1**: khÃ´ng cÃ³ import table â†’ loáº¡i
- **Dump2**: cÃ³ Ä‘áº§y Ä‘á»§ thÃ´ng tin PE â†’ **chá»n dump2**

**MD5:** `59cd9a688eddff21cbc9dc31b4f77b35`

![ThÃ´ng tin PE Dump2](Pasted%20image%2020251003081019.png)

Khi phÃ¢n tÃ­ch trÃªn VirusTotal hash má»›i nÃ y, cÃ³ thá»ƒ tháº¥y:

- Nhiá»u chuá»—i command & control, URL, lá»‡nh táº£i vá» (download)
- Äáº·c trÆ°ng cá»§a payload ransomware Teslacrypt

![VirusTotal payload](Pasted%20image%2020251003081551.png)

---

## ğŸ“ 5. Káº¿t luáº­n

- Máº«u `demo1_ransomware.bin` **Ä‘Æ°á»£c pack** (entropy cao, gá»i VirtualAlloc Ä‘á»ƒ giáº£i nÃ©n).
- Qua debug, Ä‘Ã£ **dump thÃ nh cÃ´ng payload** táº¡i láº§n cáº¥p phÃ¡t thá»© nháº¥t.
- Payload dump (`dump2`) chá»©a Ä‘áº§y Ä‘á»§ thÃ´ng tin hoáº¡t Ä‘á»™ng cá»§a Teslacrypt ransomware.
- Dá»«ng phÃ¢n tÃ­ch táº¡i Ä‘Ã¢y Ä‘á»ƒ trÃ¡nh thá»±c thi mÃ£ Ä‘á»™c thá»±c táº¿ trÃªn mÃ¡y.

---

## ğŸ“ Ghi chÃº

- ÄÃ¢y lÃ  **ká»¹ thuáº­t unpack thá»§ cÃ´ng** cÆ¡ báº£n: theo dÃµi `VirtualAlloc`, dump memory, tÃ¬m PE header.
- DÃ¹ng tá»‘t cho cÃ¡c máº«u ransomware cá»• Ä‘iá»ƒn nhÆ° Teslacrypt.
- BÆ°á»›c tiáº¿p theo (náº¿u mÃ´i trÆ°á»ng sandbox an toÃ n): phÃ¢n tÃ­ch hÃ nh vi máº¡ng, giáº£i mÃ£ routine mÃ£ hÃ³a file, v.v.

---
