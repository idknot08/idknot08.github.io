---
title: CrackMe2
date: 2025-05-27 01:01:01 +0700
categories: [RE, Partical]
tags: [password] # TAG names should always be lowercase
description: Tìm password và phân tích hành vi sử dụng file keyfile.txt trong CrackMe.
---



## 📌 Bước 1: Kiểm tra thông tin cơ bản bằng Exeinfo PE

- File thực thi không bị pack, không bị nén
- Không có dấu hiệu sử dụng các tool như UPX, ASPack, v.v.

📸

![Thông tin Exeinfo PE](/resources/CrackMe2/Pasted%20image%2020250929170800.png)

---

## 📌 Bước 2: Chạy thử chương trình

Khi chạy chương trình `CrackMe2.exe`, xuất hiện:

- Một cửa sổ chính với thông tin đăng ký
- Một hộp thoại phụ (About)

📸

![Giao diện chính](/resources/CrackMe2/Pasted%20image%2020250929171258.png)

![Hộp thoại About](/resources/CrackMe2/Pasted%20image%2020250929171324.png)

---

## 📌 Bước 3: Phân tích bằng IDA Pro

Sử dụng IDA để tìm các chuỗi liên quan đến thông báo hiển thị.

📸

![Chuỗi thông báo trong chương trình](/resources/CrackMe2/Pasted%20image%2020250929172107.png)

Có thể thấy các chuỗi được sử dụng trong hàm `DialogFunc`.

📸

![Hàm DialogFunc](/resources/CrackMe2/Pasted%20image%2020250929172244.png)

---

## 📌 Bước 4: Phân tích hàm `WinMain`

- Hàm `DialogFunc` được gọi trong `WinMain`
- Trong đó, chương trình gọi `CreateFileA` để **kiểm tra sự tồn tại của file `keyfile.txt`**
- Nếu file tồn tại → gọi `ReadFileEx` → đọc nội dung file → **nối vào chuỗi `"Registered to: "`**
- Kết quả hiển thị trong hộp thoại

📸

![Kiểm tra file keyfile.txt và đọc nội dung](/resources/CrackMe2/Pasted%20image%2020250929172844.png)

---

## 📌 Bước 5: Tạo file `keyfile.txt` và kiểm thử

- Tạo một file `keyfile.txt` cùng thư mục với chương trình
- Ghi nội dung bất kỳ, ví dụ:


📸
![File keyfile.txt](/resources/CrackMe2/Pasted%20image%2020250929173203.png)

---

## 📌 Bước 6: Chạy lại chương trình với file key

Sau khi thêm `keyfile.txt`:

- Chạy lại chương trình
- Hộp thoại hiển thị thông tin đã được nối vào `"Registered to: ..."`

📸

![Hiển thị chuỗi đã ghép từ file](/resources/CrackMe2/Pasted%20image%2020250929173224.png)

![Thông tin đăng ký thành công](/resources/CrackMe2/Pasted%20image%2020250929173237.png)

---

## ✅ Kết luận

- CrackMe2 sử dụng file `keyfile.txt` để hiển thị thông tin đăng ký
- Không có kỹ thuật chống phân tích hay packer, phù hợp để luyện tập cơ bản
- Từ hành vi chương trình có thể xác định rõ chuỗi được đọc từ file ngoài, không có cơ chế kiểm tra nội dung phức tạp

---

## 🔗 Ghi chú thêm

- Đây là dạng CrackMe kiểm tra **file ngoài** thay vì **so sánh trực tiếp chuỗi trong code**
- Có thể mở rộng kỹ thuật này thành các bài bảo vệ license hoặc anti-debug

---
