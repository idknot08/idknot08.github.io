---
title: CrackMe4
date: 2025-05-29 01:01:01 +0700
categories: [RE, Patch]
tags: [trial, patching]
description: Patch chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ vÆ°á»£t qua giá»›i háº¡n 30 ngÃ y dÃ¹ng thá»­ báº±ng cÃ¡ch thay Ä‘á»•i giÃ¡ trá»‹ sá»‘ ngÃ y trong lá»‡nh khá»Ÿi táº¡o.
---

# ğŸ› ï¸ CrackMe4 â€“ VÆ°á»£t qua giá»›i háº¡n dÃ¹ng thá»­ 30 ngÃ y

---

## ğŸ¯ Má»¥c tiÃªu

1. **Bá» giá»›i háº¡n 30 ngÃ y dÃ¹ng thá»­** (hiá»ƒn thá»‹ vÃ  logic thá»±c thi)
2. **Chuyá»ƒn thÃ´ng tin trong About** thÃ nh cÃ²n ráº¥t nhiá»u ngÃ y (Ä‘á»“ng bá»™ vá»›i sá»­a Ä‘á»•i logic)

---

## ğŸ“Œ BÆ°á»›c 1: Kiá»ƒm tra thÃ´ng tin cÆ¡ báº£n

Sá»­ dá»¥ng **Exeinfo PE**:

- PE32 (32-bit)
- KhÃ´ng bá»‹ pack
- Cháº¡y á»Ÿ cháº¿ Ä‘á»™ GUI

ğŸ“¸

![ThÃ´ng tin cÆ¡ báº£n trong Exeinfo PE](/resources/CrackMe4/Pasted%20image%2020250930165306.png)

---

## ğŸ“Œ BÆ°á»›c 2: Cháº¡y thá»­ chÆ°Æ¡ng trÃ¬nh

Khi cháº¡y file thá»±c thi:

- Giao diá»‡n chÃ­nh hiá»ƒn thá»‹ cáº£nh bÃ¡o ngÃ y trial cÃ²n láº¡i
- Má»¥c **About** cÅ©ng hiá»ƒn thá»‹ sá»‘ ngÃ y cÃ²n láº¡i

ğŸ“¸

![ThÃ´ng bÃ¡o Trial](/resources/CrackMe4/Pasted%20image%2020250930165600.png)

![About hiá»ƒn thá»‹ sá»‘ ngÃ y cÃ²n láº¡i](/resources/CrackMe4/Pasted%20image%2020250930165632.png)

â†’ CÃ³ thá»ƒ dÃ¹ng cÃ¡c chuá»—i â€œTrial Period has expiredâ€ Ä‘á»ƒ lÃ m Ä‘iá»ƒm báº¯t Ä‘áº§u phÃ¢n tÃ­ch trong IDA.

---

## ğŸ“Œ BÆ°á»›c 3: PhÃ¢n tÃ­ch trong IDA

### ğŸ” TÃ¬m chuá»—i

TÃ¬m chuá»—i `"Trial Period has expired"` trong IDA â†’ truy ngÆ°á»£c vá» **hÃ m `WinMain`**

ğŸ“¸

![TÃ¬m chuá»—i Trial trong IDA](/resources/CrackMe4/Pasted%20image%2020250930165836.png)

![WinMain chá»©a logic kiá»ƒm tra thá»i gian](/resources/CrackMe4/Pasted%20image%2020250930165938.png)

---

## ğŸ“Œ BÆ°á»›c 4: Hiá»ƒu logic kiá»ƒm tra sá»‘ ngÃ y

PhÃ¢n tÃ­ch Assembly:

```asm
mov     ecx, 1Eh          ; 30 ngÃ y
sub     ecx, eax          ; eax = sá»‘ ngÃ y Ä‘Ã£ sá»­ dá»¥ng
mov     ?daysRemainingInt@@3HA, ecx
````

â†’ ChÆ°Æ¡ng trÃ¬nh tÃ­nh `daysRemaining = 30 - currentDay`

âœ… **Giáº£i phÃ¡p:** Thay `1Eh` báº±ng `0FFh` â†’ sáº½ hiá»ƒn thá»‹ sá»‘ ngÃ y ráº¥t lá»›n (255 ngÃ y).

ğŸ“¸
![Thay Ä‘á»•i giÃ¡ trá»‹ tá»« 1Eh sang FFh](/resources/CrackMe4/Pasted%20image%2020250930170335.png)

---

## ğŸ“Œ BÆ°á»›c 5: PhÃ¢n tÃ­ch pháº§n hiá»ƒn thá»‹ trong About

TÃ¬m chuá»—i `"Trial Period has expired"` trong IDA, tháº¥y nÃ³ náº±m trong **hÃ m Callback**

ğŸ“¸

![Callback hiá»ƒn thá»‹ sá»‘ ngÃ y](/resources/CrackMe4/Pasted%20image%2020250930170734.png)

![Callback Ä‘Æ°á»£c gá»i trong WinMain](/resources/CrackMe4/Pasted%20image%2020250930170829.png)

* HÃ m Callback láº¥y giÃ¡ trá»‹ tá»« biáº¿n toÃ n cá»¥c `?daysRemainingInt@@3HA`
* GiÃ¡ trá»‹ nÃ y Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t trong **WinMain**

âœ… â†’ **KhÃ´ng cáº§n sá»­a gÃ¬ thÃªm**. Sá»­a táº¡i bÆ°á»›c 4 Ä‘Ã£ tÃ¡c Ä‘á»™ng luÃ´n Ä‘áº¿n pháº§n About.

---

## ğŸ’¾ BÆ°á»›c 6: LÆ°u vÃ  kiá»ƒm thá»­

LÆ°u chÆ°Æ¡ng trÃ¬nh Ä‘Ã£ patch láº¡i:

ğŸ“¸
![LÆ°u chÆ°Æ¡ng trÃ¬nh Ä‘Ã£ chá»‰nh sá»­a](/resources/CrackMe4/Pasted%20image%2020250930172424.png)

Cháº¡y thá»­ â†’ chÆ°Æ¡ng trÃ¬nh hiá»ƒn thá»‹ â€œDays Remaining: 255â€

ğŸ“¸
![Hiá»ƒn thá»‹ sau khi patch thÃ nh cÃ´ng](/resources/CrackMe4/Pasted%20image%2020250930172513.png)

---

## âœ… Káº¿t luáº­n

* CrackMe4 sá»­ dá»¥ng cÃ¡ch tÃ­nh sá»‘ ngÃ y dÃ¹ng thá»­ ráº¥t Ä‘Æ¡n giáº£n: `daysRemaining = 30 - daysUsed`
* Viá»‡c patch cá»±c ká»³ nháº¹: chá»‰ cáº§n **sá»­a 1 byte** (`1Eh` â†’ `0FFh`)
* Pháº§n hiá»ƒn thá»‹ trong About sá»­ dá»¥ng láº¡i giÃ¡ trá»‹ tÃ­nh toÃ¡n â†’ **khÃ´ng cáº§n sá»­a thÃªm**
