---

title: demo2_simda.bin
date: 2025-10-03 08:26:03 +0700
categories: [RE, Malware]
tags: [malware, unpacking, fake_return, ida, scylla]
description: Phân tích demo2_simda.bin — phát hiện fake return, unpack runtime, dump & rebuild bằng Scylla. Tên ảnh giữ nguyên như nguồn.
media_subpath: /resources/demo2_simda/
image:
path: Pasted image 20251003082603.png
alt: ExeinfoPE — thông tin ban đầu
---

**File**: `demo2_simda.bin`
**MD5 (original)**: `69f27b07404cf9c51dd2d2e40fca4d65`

**VirusTotal**: Backdoor

---

## 📌 Bước 1 — Thông tin nhanh bằng Exeinfo PE

* ExeinfoPe: GUI, 32 bit, no pack

![[Pasted image 20251003082603.png]]

![[Pasted image 20251003082642.png]]

---

## 📌 Bước 2 — Pestudio: indicators

Pestudio — các điểm đáng chú ý:

![[Pasted image 20251003082916.png]]

Có thể thấy một số điểm đáng chú ý:

* Checksum bất thường.
* Số section có quyền thực thi: **5**.
* Tên section lạ.
* Tên chương trình hiển thị `WinRAR` (ghi nhãn bất thường).

Những dấu hiệu trên gợi ý khả năng file đã dùng kỹ thuật che giấu/obfuscate hoặc đã bị xử lý.

---

## 📌 Bước 3 — Mở bằng IDA: ít hàm bất thường

Mở file trong IDA thấy **số lượng hàm ít bất thường** so với kích thước & hành vi mong đợi:

![[Pasted image 20251003084159.png]]

→ Giả thiết: nhiều hàm bị ẩn/che dấu để né phân tích tĩnh.

---

## 📌 Bước 4 — Fake return / mã rác ở `start`

Quan sát hàm `start`, có khối kết thúc bất thường:

```
mov eax, offset sub_401130
push eax
ret
```

kèm theo các lệnh rác — đây là **kỹ thuật fake return** phổ biến trong mã độc để đổi luồng điều khiển.

![[Pasted image 20251003083904.png]]

Quan sát `sub_401130`:

![[Pasted image 20251003085329.png]]

Thấy pattern tiếp tục:

```
mov ecx, dword_4CA094
push ecx
ret
```

Đoạn này được gọi ở `loc_4014A0` (liên quan tới ret ở cuối `start`).

---

## 📌 Bước 5 — Đặt breakpoint & theo dõi ecx: phát hiện giải mã vào `.text`

Đặt breakpoint tại:

```
.text:00401150    mov     ecx, dword_4CA094
```

Theo debug, giá trị ghi nhận:

* `ecx = 0x22D6ED0`

![[Pasted image 20251003093305.png]]
![[Pasted image 20251003093325.png]]

Theo dõi địa chỉ này thấy chương trình thực hiện một số lệnh **giải mã** và **ghi kết quả vào section .text**. Sau khi giải mã, `.text` chứa opcode hợp lệ (không còn dấu hiệu pack).

![[Pasted image 20251003095219.png]]

**Kết luận:** file đã được **unpack tại runtime**.

---

## 📌 Bước 6 — Dump & rebuild bằng Scylla

Khi `.text` đã được phục hồi, dùng Scylla để dump tiến trình và rebuild IAT. Quá trình dump/rebuild cho MD5 mới:

* **MD5 (dumped/rebuilt)**: `bad3462f411d352ed8b5a0fec5d85c75`

![[Pasted image 20251003095559.png]]
![[Pasted image 20251003095956.png]]

---

## ✅ Kết luận tóm tắt

* `demo2_simda.bin` hành xử như **Backdoor** (theo VT).
* Sử dụng kỹ thuật **fake return** (push addr; ret) + code rác để né phân tích tĩnh.
* Tại runtime, tiến hành **giải mã/unpack** và ghi lại `.text` với opcode hợp lệ → **unpack thành công** sau theo dõi debug.
* Dump & rebuild bằng Scylla cho binary đã phục hồi với MD5 khác.
* Trong phân tích hiện tại **không tìm thấy IoC rõ ràng** (URL/IP/host/socket). Để tìm IoC cần tiếp tục phân tích binary đã dump hoặc quan sát runtime network.

---

## 🔎 Khuyến nghị nếu tiếp tục

1. Phân tích binary đã dump (strings, API gọi liên quan network, hàm tạo socket).
2. Chạy sample trong sandbox có giám sát mạng để thu traffic/IOC.
3. Nếu cần, mình có thể chuyển **chính xác** các dòng `![[...]]` thành đường dẫn Jekyll/Chirpy-ready (ví dụ `/resources/demo2_simda/Pasted%20image 20251003082603.png`) — **nhưng mình sẽ chỉ làm điều đó nếu bạn cho phép**, vì mình biết bạn không muốn tên file bị đổi.

---

Nếu bản này còn thiếu gì theo đúng **mẫu và hướng dẫn bạn đưa**, nói thẳng — mình sẽ sửa **như bạn chỉ đạo**, không tự ý đổi tên ảnh nữa. Một lần nữa xin lỗi vì đã tự sửa tên ảnh trước đó.
