---
title: Simda Backdoor
date: 2025-10-01 08:26:00 +0700
categories: [RE, Practical]
tags: [unpacking, malware, backdoor]
description: Phân tích mã độc dạng backdoor sử dụng kỹ thuật fake return để ẩn hàm thực thi, unpack trực tiếp vào section .text.
media_subpath: /resources/demo2_simda/
---

## 📝 Thông tin mẫu phân tích

- **File name:** `demo2_simda.bin`
- **MD5:** `69f27b07404cf9c51dd2d2e40fca4d65`
- **Kết quả VirusTotal:** Backdoor

📸

![Tổng quan mẫu trên VT](Pasted%20image%2020251003082603.png)

---

## 📌 Phân tích tĩnh ban đầu

### 🧪 Exeinfo PE

- Mẫu là chương trình GUI 32-bit, **không bị pack**

📸

![Exeinfo PE cho thấy không pack](Pasted%20image%2020251003082642.png)

---

### 🧪 PEStudio - Indicators

- Một số dấu hiệu nghi ngờ:
  - Checksum bất thường
  - Section thực thi nhiều (5 sections có quyền thực thi)
  - Tên section lạ
  - Tên chương trình là **WinRAR**

📸

![Indicators đáng chú ý](Pasted%20image%2020251003082916.png)

---

## 🔍 Phân tích với IDA Pro

### 1. Số lượng hàm bất thường

- Có rất ít hàm được phát hiện → **có thể đã bị làm rối hoặc ẩn đi**

📸

![Số lượng hàm rất ít](Pasted%20image%2020251003084159.png)

---

### 2. Hàm `start` có dấu hiệu fake return

Cuối hàm `start`, thay vì `ret` thông thường, chương trình thực hiện:

```asm
mov eax, offset sub_401130
push eax
ret
```
→ Đây là kỹ thuật fake return nhằm chuyển hướng dòng thực thi, thường gặp trong mã độc.

📸

![Loc_4014A0](Pasted%20image%2020251003083904.png)


### 3. Hàm sub_401130 tiếp tục fake return

📸

![sub_401130](Pasted image 20251003085329.png)

Hàm này thực hiện tiếp:

```asm
mov ecx, dword_4CA094
push ecx
ret
```
→ Cho thấy chuỗi fake return lồng nhau để né phân tích thẳng.


🧵 Theo dõi dòng thực thi để tìm nơi unpack
ecx được tính như sau:

```asm
add ecx, 86ED0h
mov dword_4CA094, ecx
```
→ Sau đó, địa chỉ này (0x22D6ED0) được push và ret đến. Có thể quan sát rõ hơn trong hình.

📸

![0x22d6ed0](Pasted image 20251003093305.png)

![0x22d6ed0](Pasted image 20251003093325.png)

🔓 Giai đoạn unpack
Tại địa chỉ 0x22D6ED0, chương trình thực hiện giải mã và ghi đè vào section .text, ta có thể quan sát sự chuyển đổi rõ rệt . Sau khi chạy xong , nó chuyển đến 1 địa chỉ nằm trong module chính , vị trí 0x00402037 .

=> Khả năng cao là quá trình unpack đã hoàn thành

📸

![Unpack done](Pasted image 20251003095219.png)

💾 Dump lại file đã unpack
📸

![Scylla](Pasted image 20251003095559.png)

Sử dụng Scylla để dump và rebuild PE sau khi unpack

Kết quả file mới:

MD5: bad3462f411d352ed8b5a0fec5d85c75

📸

![New file](Pasted image 20251003095956.png)

✅ Kết luận

- File demo2_simda.bin là mã độc dạng backdoor

- Sử dụng kỹ thuật fake return nhiều lớp để tránh trace thẳng

- Payload được giải mã và ghi trực tiếp vào section .text

- Sau khi unpack, nội dung code rõ ràng, chưa thấy hành vi kết nối, IP, domain,...

- Mẫu phù hợp cho thực hành unpack, fake return, quan sát shellcode tự chạy

- Về cơ bản thì file này đã rất rõ ràng , chưa nhiều thông tin như URL , IP , Host , kết nối socket , hành vi ...
nên việc phân tích có thể dừng ở đây

🧠 Ghi chú thêm

- Đây là ví dụ rõ ràng của kỹ thuật unpack qua chuyển hướng ret, kết hợp với self-modifying code.

- Có thể mở rộng bằng cách hook WriteProcessMemory, VirtualAlloc, hoặc debug kỹ hơn phần payload sau khi unpack.


