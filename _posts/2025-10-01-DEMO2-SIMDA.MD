---
title: Simda Backdoor
date: 2025-10-01 08:26:00 +0700
categories: [RE, Practical]
tags: [unpacking, malware, backdoor]
description: PhÃ¢n tÃ­ch mÃ£ Ä‘á»™c dáº¡ng backdoor sá»­ dá»¥ng ká»¹ thuáº­t fake return Ä‘á»ƒ áº©n hÃ m thá»±c thi, unpack trá»±c tiáº¿p vÃ o section .text.
media_subpath: /resources/demo2_simda/
---

## ğŸ“ ThÃ´ng tin máº«u phÃ¢n tÃ­ch

- **File name:** `demo2_simda.bin`
- **MD5:** `69f27b07404cf9c51dd2d2e40fca4d65`
- **Káº¿t quáº£ VirusTotal:** Backdoor

ğŸ“¸

![Tá»•ng quan máº«u trÃªn VT](Pasted%20image%2020251003082603.png)

---

## ğŸ“Œ PhÃ¢n tÃ­ch tÄ©nh ban Ä‘áº§u

### ğŸ§ª Exeinfo PE

- Máº«u lÃ  chÆ°Æ¡ng trÃ¬nh GUI 32-bit, **khÃ´ng bá»‹ pack**

ğŸ“¸

![Exeinfo PE cho tháº¥y khÃ´ng pack](Pasted%20image%2020251003082642.png)

---

### ğŸ§ª PEStudio - Indicators

- Má»™t sá»‘ dáº¥u hiá»‡u nghi ngá»:
  - Checksum báº¥t thÆ°á»ng
  - Section thá»±c thi nhiá»u (5 sections cÃ³ quyá»n thá»±c thi)
  - TÃªn section láº¡
  - TÃªn chÆ°Æ¡ng trÃ¬nh lÃ  **WinRAR**

ğŸ“¸

![Indicators Ä‘Ã¡ng chÃº Ã½](Pasted%20image%2020251003082916.png)

---

## ğŸ” PhÃ¢n tÃ­ch vá»›i IDA Pro

### 1. Sá»‘ lÆ°á»£ng hÃ m báº¥t thÆ°á»ng

- CÃ³ ráº¥t Ã­t hÃ m Ä‘Æ°á»£c phÃ¡t hiá»‡n â†’ **cÃ³ thá»ƒ Ä‘Ã£ bá»‹ lÃ m rá»‘i hoáº·c áº©n Ä‘i**

ğŸ“¸

![Sá»‘ lÆ°á»£ng hÃ m ráº¥t Ã­t](Pasted%20image%2020251003084159.png)

---

### 2. HÃ m `start` cÃ³ dáº¥u hiá»‡u fake return

Cuá»‘i hÃ m `start`, thay vÃ¬ `ret` thÃ´ng thÆ°á»ng, chÆ°Æ¡ng trÃ¬nh thá»±c hiá»‡n:

```asm
mov eax, offset sub_401130
push eax
ret
```
â†’ ÄÃ¢y lÃ  ká»¹ thuáº­t fake return nháº±m chuyá»ƒn hÆ°á»›ng dÃ²ng thá»±c thi, thÆ°á»ng gáº·p trong mÃ£ Ä‘á»™c.

ğŸ“¸

![Loc_4014A0](Pasted%20image%2020251003083904.png)


### 3. HÃ m sub_401130 tiáº¿p tá»¥c fake return

ğŸ“¸

![sub_401130](Pasted image 20251003085329.png)

HÃ m nÃ y thá»±c hiá»‡n tiáº¿p:

```asm
mov ecx, dword_4CA094
push ecx
ret
```
â†’ Cho tháº¥y chuá»—i fake return lá»“ng nhau Ä‘á»ƒ nÃ© phÃ¢n tÃ­ch tháº³ng.


ğŸ§µ Theo dÃµi dÃ²ng thá»±c thi Ä‘á»ƒ tÃ¬m nÆ¡i unpack
ecx Ä‘Æ°á»£c tÃ­nh nhÆ° sau:

```asm
add ecx, 86ED0h
mov dword_4CA094, ecx
```
â†’ Sau Ä‘Ã³, Ä‘á»‹a chá»‰ nÃ y (0x22D6ED0) Ä‘Æ°á»£c push vÃ  ret Ä‘áº¿n. CÃ³ thá»ƒ quan sÃ¡t rÃµ hÆ¡n trong hÃ¬nh.

ğŸ“¸

![0x22d6ed0](Pasted image 20251003093305.png)

![0x22d6ed0](Pasted image 20251003093325.png)

ğŸ”“ Giai Ä‘oáº¡n unpack
Táº¡i Ä‘á»‹a chá»‰ 0x22D6ED0, chÆ°Æ¡ng trÃ¬nh thá»±c hiá»‡n giáº£i mÃ£ vÃ  ghi Ä‘Ã¨ vÃ o section .text, ta cÃ³ thá»ƒ quan sÃ¡t sá»± chuyá»ƒn Ä‘á»•i rÃµ rá»‡t . Sau khi cháº¡y xong , nÃ³ chuyá»ƒn Ä‘áº¿n 1 Ä‘á»‹a chá»‰ náº±m trong module chÃ­nh , vá»‹ trÃ­ 0x00402037 .

=> Kháº£ nÄƒng cao lÃ  quÃ¡ trÃ¬nh unpack Ä‘Ã£ hoÃ n thÃ nh

ğŸ“¸

![Unpack done](Pasted image 20251003095219.png)

ğŸ’¾ Dump láº¡i file Ä‘Ã£ unpack
ğŸ“¸

![Scylla](Pasted image 20251003095559.png)

Sá»­ dá»¥ng Scylla Ä‘á»ƒ dump vÃ  rebuild PE sau khi unpack

Káº¿t quáº£ file má»›i:

MD5: bad3462f411d352ed8b5a0fec5d85c75

ğŸ“¸

![New file](Pasted image 20251003095956.png)

âœ… Káº¿t luáº­n

- File demo2_simda.bin lÃ  mÃ£ Ä‘á»™c dáº¡ng backdoor

- Sá»­ dá»¥ng ká»¹ thuáº­t fake return nhiá»u lá»›p Ä‘á»ƒ trÃ¡nh trace tháº³ng

- Payload Ä‘Æ°á»£c giáº£i mÃ£ vÃ  ghi trá»±c tiáº¿p vÃ o section .text

- Sau khi unpack, ná»™i dung code rÃµ rÃ ng, chÆ°a tháº¥y hÃ nh vi káº¿t ná»‘i, IP, domain,...

- Máº«u phÃ¹ há»£p cho thá»±c hÃ nh unpack, fake return, quan sÃ¡t shellcode tá»± cháº¡y

- Vá» cÆ¡ báº£n thÃ¬ file nÃ y Ä‘Ã£ ráº¥t rÃµ rÃ ng , chÆ°a nhiá»u thÃ´ng tin nhÆ° URL , IP , Host , káº¿t ná»‘i socket , hÃ nh vi ...
nÃªn viá»‡c phÃ¢n tÃ­ch cÃ³ thá»ƒ dá»«ng á»Ÿ Ä‘Ã¢y

ğŸ§  Ghi chÃº thÃªm

- ÄÃ¢y lÃ  vÃ­ dá»¥ rÃµ rÃ ng cá»§a ká»¹ thuáº­t unpack qua chuyá»ƒn hÆ°á»›ng ret, káº¿t há»£p vá»›i self-modifying code.

- CÃ³ thá»ƒ má»Ÿ rá»™ng báº±ng cÃ¡ch hook WriteProcessMemory, VirtualAlloc, hoáº·c debug ká»¹ hÆ¡n pháº§n payload sau khi unpack.


