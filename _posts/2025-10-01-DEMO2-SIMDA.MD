---

title: demo2_simda.bin
date: 2025-10-03 08:26:03 +0700
categories: [RE, Malware]
tags: [malware, unpacking, fake_return, ida, scylla]
description: PhÃ¢n tÃ­ch demo2_simda.bin â€” phÃ¡t hiá»‡n fake return, unpack runtime, dump & rebuild báº±ng Scylla. TÃªn áº£nh giá»¯ nguyÃªn nhÆ° nguá»“n.
media_subpath: /resources/demo2_simda/
image:
path: Pasted image 20251003082603.png
alt: ExeinfoPE â€” thÃ´ng tin ban Ä‘áº§u
---

**File**: `demo2_simda.bin`
**MD5 (original)**: `69f27b07404cf9c51dd2d2e40fca4d65`

**VirusTotal**: Backdoor

---

## ğŸ“Œ BÆ°á»›c 1 â€” ThÃ´ng tin nhanh báº±ng Exeinfo PE

* ExeinfoPe: GUI, 32 bit, no pack

![[Pasted image 20251003082603.png]]

![[Pasted image 20251003082642.png]]

---

## ğŸ“Œ BÆ°á»›c 2 â€” Pestudio: indicators

Pestudio â€” cÃ¡c Ä‘iá»ƒm Ä‘Ã¡ng chÃº Ã½:

![[Pasted image 20251003082916.png]]

CÃ³ thá»ƒ tháº¥y má»™t sá»‘ Ä‘iá»ƒm Ä‘Ã¡ng chÃº Ã½:

* Checksum báº¥t thÆ°á»ng.
* Sá»‘ section cÃ³ quyá»n thá»±c thi: **5**.
* TÃªn section láº¡.
* TÃªn chÆ°Æ¡ng trÃ¬nh hiá»ƒn thá»‹ `WinRAR` (ghi nhÃ£n báº¥t thÆ°á»ng).

Nhá»¯ng dáº¥u hiá»‡u trÃªn gá»£i Ã½ kháº£ nÄƒng file Ä‘Ã£ dÃ¹ng ká»¹ thuáº­t che giáº¥u/obfuscate hoáº·c Ä‘Ã£ bá»‹ xá»­ lÃ½.

---

## ğŸ“Œ BÆ°á»›c 3 â€” Má»Ÿ báº±ng IDA: Ã­t hÃ m báº¥t thÆ°á»ng

Má»Ÿ file trong IDA tháº¥y **sá»‘ lÆ°á»£ng hÃ m Ã­t báº¥t thÆ°á»ng** so vá»›i kÃ­ch thÆ°á»›c & hÃ nh vi mong Ä‘á»£i:

![[Pasted image 20251003084159.png]]

â†’ Giáº£ thiáº¿t: nhiá»u hÃ m bá»‹ áº©n/che dáº¥u Ä‘á»ƒ nÃ© phÃ¢n tÃ­ch tÄ©nh.

---

## ğŸ“Œ BÆ°á»›c 4 â€” Fake return / mÃ£ rÃ¡c á»Ÿ `start`

Quan sÃ¡t hÃ m `start`, cÃ³ khá»‘i káº¿t thÃºc báº¥t thÆ°á»ng:

```
mov eax, offset sub_401130
push eax
ret
```

kÃ¨m theo cÃ¡c lá»‡nh rÃ¡c â€” Ä‘Ã¢y lÃ  **ká»¹ thuáº­t fake return** phá»• biáº¿n trong mÃ£ Ä‘á»™c Ä‘á»ƒ Ä‘á»•i luá»“ng Ä‘iá»u khiá»ƒn.

![[Pasted image 20251003083904.png]]

Quan sÃ¡t `sub_401130`:

![[Pasted image 20251003085329.png]]

Tháº¥y pattern tiáº¿p tá»¥c:

```
mov ecx, dword_4CA094
push ecx
ret
```

Äoáº¡n nÃ y Ä‘Æ°á»£c gá»i á»Ÿ `loc_4014A0` (liÃªn quan tá»›i ret á»Ÿ cuá»‘i `start`).

---

## ğŸ“Œ BÆ°á»›c 5 â€” Äáº·t breakpoint & theo dÃµi ecx: phÃ¡t hiá»‡n giáº£i mÃ£ vÃ o `.text`

Äáº·t breakpoint táº¡i:

```
.text:00401150    mov     ecx, dword_4CA094
```

Theo debug, giÃ¡ trá»‹ ghi nháº­n:

* `ecx = 0x22D6ED0`

![[Pasted image 20251003093305.png]]
![[Pasted image 20251003093325.png]]

Theo dÃµi Ä‘á»‹a chá»‰ nÃ y tháº¥y chÆ°Æ¡ng trÃ¬nh thá»±c hiá»‡n má»™t sá»‘ lá»‡nh **giáº£i mÃ£** vÃ  **ghi káº¿t quáº£ vÃ o section .text**. Sau khi giáº£i mÃ£, `.text` chá»©a opcode há»£p lá»‡ (khÃ´ng cÃ²n dáº¥u hiá»‡u pack).

![[Pasted image 20251003095219.png]]

**Káº¿t luáº­n:** file Ä‘Ã£ Ä‘Æ°á»£c **unpack táº¡i runtime**.

---

## ğŸ“Œ BÆ°á»›c 6 â€” Dump & rebuild báº±ng Scylla

Khi `.text` Ä‘Ã£ Ä‘Æ°á»£c phá»¥c há»“i, dÃ¹ng Scylla Ä‘á»ƒ dump tiáº¿n trÃ¬nh vÃ  rebuild IAT. QuÃ¡ trÃ¬nh dump/rebuild cho MD5 má»›i:

* **MD5 (dumped/rebuilt)**: `bad3462f411d352ed8b5a0fec5d85c75`

![[Pasted image 20251003095559.png]]
![[Pasted image 20251003095956.png]]

---

## âœ… Káº¿t luáº­n tÃ³m táº¯t

* `demo2_simda.bin` hÃ nh xá»­ nhÆ° **Backdoor** (theo VT).
* Sá»­ dá»¥ng ká»¹ thuáº­t **fake return** (push addr; ret) + code rÃ¡c Ä‘á»ƒ nÃ© phÃ¢n tÃ­ch tÄ©nh.
* Táº¡i runtime, tiáº¿n hÃ nh **giáº£i mÃ£/unpack** vÃ  ghi láº¡i `.text` vá»›i opcode há»£p lá»‡ â†’ **unpack thÃ nh cÃ´ng** sau theo dÃµi debug.
* Dump & rebuild báº±ng Scylla cho binary Ä‘Ã£ phá»¥c há»“i vá»›i MD5 khÃ¡c.
* Trong phÃ¢n tÃ­ch hiá»‡n táº¡i **khÃ´ng tÃ¬m tháº¥y IoC rÃµ rÃ ng** (URL/IP/host/socket). Äá»ƒ tÃ¬m IoC cáº§n tiáº¿p tá»¥c phÃ¢n tÃ­ch binary Ä‘Ã£ dump hoáº·c quan sÃ¡t runtime network.

---

## ğŸ” Khuyáº¿n nghá»‹ náº¿u tiáº¿p tá»¥c

1. PhÃ¢n tÃ­ch binary Ä‘Ã£ dump (strings, API gá»i liÃªn quan network, hÃ m táº¡o socket).
2. Cháº¡y sample trong sandbox cÃ³ giÃ¡m sÃ¡t máº¡ng Ä‘á»ƒ thu traffic/IOC.
3. Náº¿u cáº§n, mÃ¬nh cÃ³ thá»ƒ chuyá»ƒn **chÃ­nh xÃ¡c** cÃ¡c dÃ²ng `![[...]]` thÃ nh Ä‘Æ°á»ng dáº«n Jekyll/Chirpy-ready (vÃ­ dá»¥ `/resources/demo2_simda/Pasted%20image 20251003082603.png`) â€” **nhÆ°ng mÃ¬nh sáº½ chá»‰ lÃ m Ä‘iá»u Ä‘Ã³ náº¿u báº¡n cho phÃ©p**, vÃ¬ mÃ¬nh biáº¿t báº¡n khÃ´ng muá»‘n tÃªn file bá»‹ Ä‘á»•i.

---

Náº¿u báº£n nÃ y cÃ²n thiáº¿u gÃ¬ theo Ä‘Ãºng **máº«u vÃ  hÆ°á»›ng dáº«n báº¡n Ä‘Æ°a**, nÃ³i tháº³ng â€” mÃ¬nh sáº½ sá»­a **nhÆ° báº¡n chá»‰ Ä‘áº¡o**, khÃ´ng tá»± Ã½ Ä‘á»•i tÃªn áº£nh ná»¯a. Má»™t láº§n ná»¯a xin lá»—i vÃ¬ Ä‘Ã£ tá»± sá»­a tÃªn áº£nh trÆ°á»›c Ä‘Ã³.
