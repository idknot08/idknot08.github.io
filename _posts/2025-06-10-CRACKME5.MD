---
title: CrackMe5
date: 2025-06-10 01:01:01 +0700
categories: [RE, SerialCrack]
tags: [serial, crackme, patch, reverse]
description: Phân tích và tìm ra serial key hợp lệ dựa trên tên người dùng nhập vào bằng kỹ thuật debug và reverse engineering.
---

# 🛠️ CrackMe5 – Tìm Serial Key theo Firstname

---

## 🎯 Objectives

1. Nhập tên bất kỳ (Firstname)
2. **Tìm serial key hợp lệ** tương ứng với tên đó để qua được kiểm tra

---

## 📌 Bước 1: Kiểm tra thông tin cơ bản

Sử dụng **Exeinfo PE**:

- PE32 (32-bit)
- Not packed
- GUI application

📸

![Thông tin cơ bản](/resources/CrackMe5/Pasted%20image%2020250930175327.png)

---

## 📌 Bước 2: Chạy thử chương trình

Khi khởi chạy:

- Giao diện hiển thị yêu cầu nhập Firstname và Serial Key

📸

![Giao diện yêu cầu nhập](/resources/CrackMe5/Pasted%20image%2020250930175512.png)

![Hộp thoại nhập Serial](/resources/CrackMe5/Pasted%20image%2020250930175525.png)

> Mục **About** chỉ hiển thị thông tin tác giả → có thể bỏ qua.

---

## 📌 Bước 3: Phân tích chuỗi gợi ý trong IDA

Tìm các chuỗi như:

- `"Enter your firstname"`
- `"Enter Serial Key"`
- `"Wrong serial key. Try again."`

📸

![Các chuỗi hiển thị](/resources/CrackMe5/Pasted%20image%2020250930175910.png)

Xác định `"Wrong serial key..."` được sử dụng trong hàm **DialogFunc**

📸

![DialogFunc – Hàm kiểm tra key](/resources/CrackMe5/Pasted%20image%2020250930175859.png)

---

## 📌 Bước 4: Phát hiện khối tính toán Serial Key

Dò theo luồng xử lý trong `DialogFunc`, ta thấy chương trình:

- Nhận input (tên)
- Thực hiện phép tính và tạo chuỗi key bằng `wsprintfA`
- Push kết quả ra stack

📸

![Khối lệnh tính toán Serial Key](/resources/CrackMe5/Pasted%20image%2020250930180503.png)

→ **Ý tưởng**: Đặt breakpoint tại lệnh `push eax` ngay trước khi gọi `wsprintfA` để kiểm tra kết quả key.

---

## 📌 Bước 5: Debug bằng IDA

Tại thời điểm gọi `wsprintfA`, đặt breakpoint tại `push eax`:

📸

![Breakpoint tại push eax](/resources/CrackMe5/Pasted%20image%2020250930181107.png)

Tại thời điểm đó:

- Thanh ghi `EAX = 0x0019F890` → là buffer chứa output của `wsprintfA`

📸

![EAX là địa chỉ kết quả](/resources/CrackMe5/Pasted%20image%2020250930181135.png)

Dò địa chỉ `0x0019F890` trong Hex View → thấy được key được sinh

📸

![Hex View hiển thị key](/resources/CrackMe5/Pasted%20image%2020250930181634.png)

→ Với input là `"test"` → key là `"test-3259930"`
⚠️ *Lưu ý: key có thể thay đổi theo thời gian hệ thống vì có thể phụ thuộc vào timestamp.*

---

## 📌 Bước 6: Kiểm thử kết quả

Nhập lại key `"test-3259930"` → chương trình hiển thị thông báo thành công!

📸

![Key đúng, chương trình mở khóa](/resources/CrackMe5/Pasted%20image%2020250930181837.png)

![Thông báo Success](/resources/CrackMe5/Pasted%20image%2020250930181852.png)

---

## ✅ Kết luận

- CrackMe5 tạo serial key dựa trên tên người dùng bằng cách gọi `wsprintfA` và kết hợp một số giá trị tính toán bên trong.
- Không cần phải phân tích toàn bộ thuật toán → chỉ cần đặt breakpoint tại thời điểm xuất kết quả là có thể lấy được serial key đúng.
- Đây là một ví dụ hay để luyện **dynamic analysis** và cách quan sát kết quả từ API gọi nội bộ.

---
