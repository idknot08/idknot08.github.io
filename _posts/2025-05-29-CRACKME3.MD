---
title: CrackMe3
date: 2025-05-29 01:01:01 +0700
categories: [RE, Patch]
tags: [nag, patching]
description: Loại bỏ thông báo Nag và chuyển trạng thái chương trình sang Registered bằng cách chỉnh sửa lệnh nhảy trong IDA.
---

# 🛠️ Write-up: CrackMe3 – Patch hộp thoại Nag và chuyển trạng thái Registered

---

## 🎯 Mục tiêu

1. **Xóa hộp thoại Nag**:
   - Một hiển thị khi khởi động
   - Một khi đóng chương trình

2. **Chuyển trạng thái ở màn hình About thành "Registered"**

---

## 📌 Bước 1: Quan sát chương trình khi chạy

Chạy `CrackMe3.exe`, xuất hiện:

- Hộp thoại **Nag khi khởi động**
- Hộp thoại **Nag khi thoát**
- Màn hình **About**, hiển thị trạng thái chưa đăng ký

📸

![Nag khi khởi động](/resources/CrackMe3/Pasted%20image%2020250929175831.png)

![Nag khi thoát](/resources/CrackMe3/Pasted%20image%2020250929175647.png)

![About chưa đăng ký](/resources/CrackMe3/Pasted%20image%2020250929180335.png)

---

## 📌 Bước 2: Kiểm tra thông tin PE

Mở bằng **Exeinfo PE**, xác định:

- PE32 (32-bit)
- Không bị pack

📸

![Exeinfo PE - 32bit Not Packed](/resources/CrackMe3/Pasted%20image%2020250929180810.png)

---

## 📌 Bước 3: Phân tích chuỗi Nag trong IDA

Tìm các chuỗi `"Opening Nag"` và `"Closing Nag"` → đây là **hai chuỗi cần xử lý**.

📸

![Tìm chuỗi Nag trong IDA](/resources/CrackMe3/Pasted%20image%2020250929181319.png)

---

### 🔧 Xử lý Opening Nag

- Quan sát lệnh điều kiện `jnz short loc_401044`
- Lệnh này sẽ **nhảy vào khối hiển thị Nag**
- Giải pháp: **đảo điều kiện thành `jz` để bỏ qua**

📸

![Trước khi patch Opening Nag](/resources/CrackMe3/Pasted%20image%2020250929182639.png)

Sửa bằng **Edit assembly** trong IDA:

📸

![Sau khi patch jnz → jz](/resources/CrackMe3/Pasted%20image%2020250929183116.png)

---

### ✅ Xử lý Closing Nag

- Mặc định chương trình **không gọi hộp thoại Closing Nag** nếu không bật Opening Nag
- → **Không cần sửa thêm**

📸

![Khối lệnh Closing Nag](/resources/CrackMe3/Pasted%20image%2020250929182933.png)

---

## 📌 Bước 4: Chuyển trạng thái sang Registered trong About

- Vào hàm xử lý About
- Tìm đoạn so sánh → nhảy đến thông báo “Unregistered”
- Sửa lệnh nhảy `jnz` → `jz` để luôn đi vào nhánh “Registered”

📸

![Patch About – đảo điều kiện nhảy](/resources/CrackMe3/Pasted%20image%2020250929183242.png)

---

## 💾 Bước 5: Lưu file đã patch và chạy thử

Sau khi chỉnh sửa xong, lưu lại file đã patch.

📸

![Lưu lại file đã chỉnh sửa](/resources/CrackMe3/Pasted%20image%2020250929183419.png)

Chạy lại chương trình đã patch:

- Không còn hộp thoại Nag
- Trạng thái đã chuyển sang **Registered**

📸

![Chương trình sau khi patch thành công](/resources/CrackMe3/Pasted%20image%2020250929184051.png)

---

## ✅ Kết luận

- Chương trình này không có mã hóa phức tạp hay bảo vệ chống sửa đổi.
- Việc patch chỉ cần:
  - Xác định đúng lệnh `jnz`
  - Đảo điều kiện thành `jz` để chuyển hướng luồng chương trình

---

## 🔐 Ghi chú kỹ thuật

- Việc đảo điều kiện trong IDA có thể thực hiện dễ dàng bằng chuột phải → **Edit → Assemble**
- Sau khi patch, nên lưu thành file `.patched.exe` riêng để so sánh với file gốc
- Kỹ thuật patch này rất phổ biến trong việc:
  - Bỏ quảng cáo
  - Bỏ giới hạn bản trial
  - Bypass kiểm tra đăng ký đơn giản

---

