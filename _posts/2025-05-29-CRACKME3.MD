---
title: CrackMe3
date: 2025-05-29 01:01:01 +0700
categories: [RE, Patch]
tags: [nag, patching]
description: Loáº¡i bá» thÃ´ng bÃ¡o Nag vÃ  chuyá»ƒn tráº¡ng thÃ¡i chÆ°Æ¡ng trÃ¬nh sang Registered báº±ng cÃ¡ch chá»‰nh sá»­a lá»‡nh nháº£y trong IDA.
---

# ğŸ› ï¸ Write-up: CrackMe3 â€“ Patch há»™p thoáº¡i Nag vÃ  chuyá»ƒn tráº¡ng thÃ¡i Registered

---

## ğŸ¯ Má»¥c tiÃªu

1. **XÃ³a há»™p thoáº¡i Nag**:
   - Má»™t hiá»ƒn thá»‹ khi khá»Ÿi Ä‘á»™ng
   - Má»™t khi Ä‘Ã³ng chÆ°Æ¡ng trÃ¬nh

2. **Chuyá»ƒn tráº¡ng thÃ¡i á»Ÿ mÃ n hÃ¬nh About thÃ nh "Registered"**

---

## ğŸ“Œ BÆ°á»›c 1: Quan sÃ¡t chÆ°Æ¡ng trÃ¬nh khi cháº¡y

Cháº¡y `CrackMe3.exe`, xuáº¥t hiá»‡n:

- Há»™p thoáº¡i **Nag khi khá»Ÿi Ä‘á»™ng**
- Há»™p thoáº¡i **Nag khi thoÃ¡t**
- MÃ n hÃ¬nh **About**, hiá»ƒn thá»‹ tráº¡ng thÃ¡i chÆ°a Ä‘Äƒng kÃ½

ğŸ“¸

![Nag khi khá»Ÿi Ä‘á»™ng](/resources/CrackMe3/Pasted%20image%2020250929175831.png)

![Nag khi thoÃ¡t](/resources/CrackMe3/Pasted%20image%2020250929175647.png)

![About chÆ°a Ä‘Äƒng kÃ½](/resources/CrackMe3/Pasted%20image%2020250929180335.png)

---

## ğŸ“Œ BÆ°á»›c 2: Kiá»ƒm tra thÃ´ng tin PE

Má»Ÿ báº±ng **Exeinfo PE**, xÃ¡c Ä‘á»‹nh:

- PE32 (32-bit)
- KhÃ´ng bá»‹ pack

ğŸ“¸

![Exeinfo PE - 32bit Not Packed](/resources/CrackMe3/Pasted%20image%2020250929180810.png)

---

## ğŸ“Œ BÆ°á»›c 3: PhÃ¢n tÃ­ch chuá»—i Nag trong IDA

TÃ¬m cÃ¡c chuá»—i `"Opening Nag"` vÃ  `"Closing Nag"` â†’ Ä‘Ã¢y lÃ  **hai chuá»—i cáº§n xá»­ lÃ½**.

ğŸ“¸

![TÃ¬m chuá»—i Nag trong IDA](/resources/CrackMe3/Pasted%20image%2020250929181319.png)

---

### ğŸ”§ Xá»­ lÃ½ Opening Nag

- Quan sÃ¡t lá»‡nh Ä‘iá»u kiá»‡n `jnz short loc_401044`
- Lá»‡nh nÃ y sáº½ **nháº£y vÃ o khá»‘i hiá»ƒn thá»‹ Nag**
- Giáº£i phÃ¡p: **Ä‘áº£o Ä‘iá»u kiá»‡n thÃ nh `jz` Ä‘á»ƒ bá» qua**

ğŸ“¸

![TrÆ°á»›c khi patch Opening Nag](/resources/CrackMe3/Pasted%20image%2020250929182639.png)

Sá»­a báº±ng **Edit assembly** trong IDA:

ğŸ“¸

![Sau khi patch jnz â†’ jz](/resources/CrackMe3/Pasted%20image%2020250929183116.png)

---

### âœ… Xá»­ lÃ½ Closing Nag

- Máº·c Ä‘á»‹nh chÆ°Æ¡ng trÃ¬nh **khÃ´ng gá»i há»™p thoáº¡i Closing Nag** náº¿u khÃ´ng báº­t Opening Nag
- â†’ **KhÃ´ng cáº§n sá»­a thÃªm**

ğŸ“¸

![Khá»‘i lá»‡nh Closing Nag](/resources/CrackMe3/Pasted%20image%2020250929182933.png)

---

## ğŸ“Œ BÆ°á»›c 4: Chuyá»ƒn tráº¡ng thÃ¡i sang Registered trong About

- VÃ o hÃ m xá»­ lÃ½ About
- TÃ¬m Ä‘oáº¡n so sÃ¡nh â†’ nháº£y Ä‘áº¿n thÃ´ng bÃ¡o â€œUnregisteredâ€
- Sá»­a lá»‡nh nháº£y `jnz` â†’ `jz` Ä‘á»ƒ luÃ´n Ä‘i vÃ o nhÃ¡nh â€œRegisteredâ€

ğŸ“¸

![Patch About â€“ Ä‘áº£o Ä‘iá»u kiá»‡n nháº£y](/resources/CrackMe3/Pasted%20image%2020250929183242.png)

---

## ğŸ’¾ BÆ°á»›c 5: LÆ°u file Ä‘Ã£ patch vÃ  cháº¡y thá»­

Sau khi chá»‰nh sá»­a xong, lÆ°u láº¡i file Ä‘Ã£ patch.

ğŸ“¸

![LÆ°u láº¡i file Ä‘Ã£ chá»‰nh sá»­a](/resources/CrackMe3/Pasted%20image%2020250929183419.png)

Cháº¡y láº¡i chÆ°Æ¡ng trÃ¬nh Ä‘Ã£ patch:

- KhÃ´ng cÃ²n há»™p thoáº¡i Nag
- Tráº¡ng thÃ¡i Ä‘Ã£ chuyá»ƒn sang **Registered**

ğŸ“¸

![ChÆ°Æ¡ng trÃ¬nh sau khi patch thÃ nh cÃ´ng](/resources/CrackMe3/Pasted%20image%2020250929184051.png)

---

## âœ… Káº¿t luáº­n

- ChÆ°Æ¡ng trÃ¬nh nÃ y khÃ´ng cÃ³ mÃ£ hÃ³a phá»©c táº¡p hay báº£o vá»‡ chá»‘ng sá»­a Ä‘á»•i.
- Viá»‡c patch chá»‰ cáº§n:
  - XÃ¡c Ä‘á»‹nh Ä‘Ãºng lá»‡nh `jnz`
  - Äáº£o Ä‘iá»u kiá»‡n thÃ nh `jz` Ä‘á»ƒ chuyá»ƒn hÆ°á»›ng luá»“ng chÆ°Æ¡ng trÃ¬nh

---

## ğŸ” Ghi chÃº ká»¹ thuáº­t

- Viá»‡c Ä‘áº£o Ä‘iá»u kiá»‡n trong IDA cÃ³ thá»ƒ thá»±c hiá»‡n dá»… dÃ ng báº±ng chuá»™t pháº£i â†’ **Edit â†’ Assemble**
- Sau khi patch, nÃªn lÆ°u thÃ nh file `.patched.exe` riÃªng Ä‘á»ƒ so sÃ¡nh vá»›i file gá»‘c
- Ká»¹ thuáº­t patch nÃ y ráº¥t phá»• biáº¿n trong viá»‡c:
  - Bá» quáº£ng cÃ¡o
  - Bá» giá»›i háº¡n báº£n trial
  - Bypass kiá»ƒm tra Ä‘Äƒng kÃ½ Ä‘Æ¡n giáº£n

---

